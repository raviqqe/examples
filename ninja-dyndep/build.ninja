rule cc
  command = scripts/cc.sh $in $out

rule dd
  command = scripts/dd.sh $in $out

build foo.o foo.h: cc foo.c || foo.dd
  dyndep = foo.dd
build bar.o bar.h: cc bar.c || bar.dd
  dyndep = bar.dd
build baz.o baz.h: cc baz.c || baz.dd
  dyndep = baz.dd

build foo.d foo.dd: dd foo.c
build bar.d bar.dd: dd bar.c
build baz.d baz.dd: dd baz.c

default foo.o
